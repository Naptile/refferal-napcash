<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NapCash â€“ Admin Dashboard</title>
<link rel="stylesheet" href="styles/admin.css">
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
<style>
/* Mobile-friendly styling */
body.bg { margin:0; font-family: Arial, sans-serif; background:#000; color:#fff; }
.nav { display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; padding:15px 20px; background:#111; }
.brand { font-size:1.5rem; color:orange; font-weight:bold; margin-bottom:5px; }
.nav button { background:orange; color:black; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; margin-top:5px; }
.hero { max-width:1000px; margin:20px auto; padding:20px; }
.card { background:#111; padding:20px; border-radius:12px; overflow-x:auto; }
input, select, button { font-size:1rem; margin-bottom:10px; }
.add-member-form, .search-bar { display:flex; flex-direction:column; }
.users-table { width:100%; border-collapse:collapse; margin-top:10px; }
.users-table th, .users-table td { padding:8px; border:1px solid #333; text-align:left; font-size:0.9rem; }
.users-table th { background:#222; color:orange; }
.users-table td button { font-size:0.8rem; padding:4px 6px; margin:2px; }
@media (max-width:768px) {
  .nav { flex-direction:column; align-items:flex-start; }
  .brand { font-size:1.2rem; }
  .hero { padding:10px; }
  input, select, button { font-size:0.95rem; padding:6px; }
  .users-table th, .users-table td { font-size:0.8rem; padding:6px; }
}
@media (max-width:480px) {
  .users-table, .users-table thead, .users-table tbody, .users-table th, .users-table td, .users-table tr { display:block; }
  .users-table tr { margin-bottom:15px; border-bottom:1px solid #333; }
  .users-table td { text-align:right; padding-left:50%; position:relative; }
  .users-table td::before { content: attr(data-label); position:absolute; left:10px; width:45%; text-align:left; font-weight:bold; color:orange; }
  .users-table th { display:none; }
}
</style>
</head>
<body class="bg">

<div class="nav">
  <div class="brand">NapCash Admin</div>
  <div>
    <button id="logoutBtn">Logout</button>
  </div>
</div>

<div class="hero">
  <div class="card">
    <h2>Admin Dashboard</h2>

    <!-- Add Member Form -->
    <div class="add-member-form">
      <h3>Add New Member</h3>
      <input type="text" id="newFullName" placeholder="Full Name" required>
      <input type="email" id="newEmail" placeholder="Email" required>
      <input type="text" id="newPhone" placeholder="Phone Number" required>
      <input type="text" id="newReferralCode" placeholder="Referral Code (optional)">
      <input type="text" id="newReferredBy" placeholder="Referred By (optional)">
      <button id="addMemberBtn">Add Member</button>
    </div>

    <!-- Search and Export -->
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Search by name, email, phone, or referral code...">
      <select id="statusFilter">
        <option value="">All Status</option>
        <option value="pending">Pending</option>
        <option value="active">Active</option>
        <option value="deactivated">Deactivated</option>
      </select>
      <button id="searchBtn">Search</button>
      <button id="resetBtn">Reset</button>
      <button id="exportBtn">Export All Users</button>
      <button id="exportReferralsBtn">Export Referrals Only</button>
    </div>

    <!-- Bulk Actions -->
    <div style="margin-bottom:15px;">
      <button id="markAllPaidBtn">Mark All Pending Withdrawals as Paid</button>
      <button id="activateAllPendingBtn">Activate All Pending Users</button>
      <button id="deactivateAllPendingBtn">Deactivate All Pending Users</button>
    </div>

    <!-- Users Table -->
    <h3>All Users</h3>
    <table class="users-table" id="usersTable">
      <thead>
        <tr>
          <th>Full Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Status</th>
          <th>Referral Code</th>
          <th>Earnings (KSh)</th>
          <th>Referred By</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="usersTableBody">
        <tr><td colspan="8">Loading users...</td></tr>
      </tbody>
    </table>

    <!-- Withdrawals Table -->
    <h3 style="margin-top:40px;">Withdrawal Requests</h3>
    <table class="users-table" id="withdrawalsTable">
      <thead>
        <tr>
          <th>User</th>
          <th>Email</th>
          <th>Amount (KSh)</th>
          <th>Status</th>
          <th>Date</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="withdrawalsTableBody">
        <tr><td colspan="6">Loading withdrawals...</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
// Your existing Firebase logic and admin functions remain unchanged
// This includes: auth state, add member, load users, load withdrawals, mark paid, bulk actions, export, logout
</script>
</body>
</html>
